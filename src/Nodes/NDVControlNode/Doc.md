# NDVControlNode 帮助文档
## 节点功能
NDV控制节点用于通过TCP协议控制NDV（Network Display Video）设备，支持以下特性：

- 远程设备控制 ：可配置目标NDV设备的IP地址和端口，支持发送控制命令
- 多种播放控制 ：支持播放、循环播放、停止等基本控制功能
- 文件索引选择 ：可指定要播放的节目文件索引
- 客户端管理 ：支持关闭所有客户端功能
- 多输入触发 ：支持通过多个输入端口触发不同控制命令
- 配置保存与加载 ：自动保存和加载IP地址和端口配置
- OSC远程控制 ：支持通过OSC协议远程控制节点功能
## 输入端口
节点提供了4个输入端口：

1. INDEX ：文件索引值（整数类型，范围0-10）
2. PLAY ：播放触发信号（布尔类型，true时触发播放）
3. LOOP ：循环播放触发信号（布尔类型，true时触发循环播放）
4. STOP ：停止播放触发信号（布尔类型，true时触发停止播放）
## 输出端口
此节点没有输出端口。

## 节点界面
节点提供了直观的用户界面，包含以下元素：

- IP地址 ：输入框，用于设置目标NDV设备的IP地址（默认：127.0.0.1）
- 端口 ：数字输入框，用于设置目标端口（范围：1000-65535，默认：8008）
- 文件索引 ：数字输入框和标签，用于设置要播放的节目文件索引（范围：0-10）
- 播放按钮 ：点击触发播放指定索引的节目文件
- 循环播放按钮 ：点击触发循环播放指定索引的节目文件
- 停止按钮 ：点击停止当前播放
- 关闭所有客户端按钮 ：点击关闭所有连接的NDV客户端
## 使用示例
### 基本控制
1. 添加NDV控制节点到工作区
2. 设置目标NDV设备的IP地址（如："192.168.1.100"）和端口（如：8008）
3. 设置要播放的节目文件索引（如：1）
4. 点击播放按钮开始播放
5. 需要停止时，点击停止按钮
### 通过其他节点控制
1. 将整数源节点（IntSourceNode）连接到NDV控制节点的INDEX端口
2. 将布尔源节点（BoolSourceNode）连接到NDV控制节点的PLAY端口
3. 当布尔源节点输出true时，NDV控制节点将自动播放整数源节点指定索引的节目文件
### 创建自动播放序列
1. 使用LFO节点生成周期性信号
2. 将LFO节点连接到逻辑操作节点，生成周期性的布尔值
3. 将布尔值连接到NDV控制节点的PLAY或LOOP端口
4. 使用整数源节点或计数器节点控制文件索引
5. 构建一个自动循环播放不同节目文件的系统
## 注意事项
- 网络连接 ：确保目标NDV设备可访问且端口开放，否则控制命令将无法送达
- 命令格式 ：节点使用特定的十六进制命令格式与NDV设备通信，无需手动构建命令
- 文件索引 ：确保指定的文件索引在NDV设备上存在，否则播放命令可能无效
- 并发控制 ：避免同时发送多个控制命令，可能导致NDV设备行为不稳定
- OSC控制 ：节点支持通过以下OSC地址远程控制：
  - /loop ：触发循环播放
  - /play ：触发播放
  - /stop ：触发停止
  - /close ：触发关闭所有客户端
  - /file ：设置文件索引
- 配置保存 ：IP地址和端口设置会自动保存到流程文件中
- 独立线程 ：TCP通信在独立线程中执行，不会阻塞主UI线程
## 技术细节
- 使用QTcpServer和QTcpSocket实现TCP通信
- 基于预定义的十六进制命令格式与NDV设备通信
- 使用QThread在独立线程中处理网络操作
- 支持通过NodeDelegateModel::registerOSCControl注册OSC控制接口
- 使用QJsonObject实现配置的保存和加载
- 界面基于Qt Widgets构建，使用QGridLayout进行布局