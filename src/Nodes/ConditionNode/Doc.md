# ConditionNode 帮助文档
## 节点功能
条件判断节点（Condition Node）用于根据JavaScript表达式对输入数据进行条件判断，支持以下特性：

- 条件判断：根据JavaScript表达式的结果返回布尔值（true/false）
- 灵活表达式：通过文本输入框可以动态指定JavaScript表达式
- 全局变量支持：输入数据自动注册为JavaScript全局变量 $input，方便在表达式中引用
- 嵌套数据访问：可以使用点表示法访问嵌套数据结构中的值（如 $input.data.position.x > 100）
- 实时数据更新：当输入数据或表达式变化时，自动更新判断结果
- 配置保存与加载：支持将表达式保存到流程文件中并在加载时恢复
- 嵌入式界面：提供简洁的嵌入式界面，方便直接在节点上编辑表达式
- 错误处理：当JavaScript表达式出现语法错误时，会在控制台输出错误信息

## 输入端口
节点提供1个输入端口：

1. INPUT 0：数据输入源，接收VariableData类型的数据

## 输出端口
节点提供1个输出端口：

1. OUTPUT 0：条件判断结果，输出布尔值（true/false）

## 节点界面
节点界面包含一个组件：

1. 文本输入框：用于输入JavaScript表达式，默认值为"$input[\"default\"]"

## 使用示例
### 示例1：基本条件判断
1. 添加条件判断节点到流程图
2. 将一个数据源节点（如IntSourceNode或MergeNode）连接到条件判断节点的输入端口
3. 在文本框中输入条件表达式，例如 $input.value > 10
4. 当输入数据满足条件（值大于10）时，节点输出true，否则输出false

### 示例2：复杂数据结构条件判断
1. 添加条件判断节点到流程图
2. 将一个包含嵌套数据的VariableData源节点连接到条件判断节点的输入端口
3. 在文本框中输入条件表达式，例如 $input.position.x > 100 && $input.position.y < 200
4. 当输入数据的位置坐标满足条件时，节点输出true，否则输出false

### 示例3：事件状态判断
1. 添加条件判断节点到流程图
2. 将一个事件源节点（如HotKeyNode或OscInNode）连接到条件判断节点的输入端口
3. 在文本框中输入条件表达式，例如 $input.triggered === true
4. 当事件被触发时，节点输出true，否则输出false

### 示例4：数据类型判断
1. 添加条件判断节点到流程图
2. 连接数据源到输入端口
3. 在文本框中输入类型判断表达式，例如 typeof $input.value === 'number'
4. 根据数据类型返回相应的布尔值

## 注意事项
1. 输入数据必须是VariableData类型，否则节点将无法处理
2. JavaScript表达式应该返回布尔值，如果返回其他类型会自动转换为布尔值
3. 表达式中可以直接使用 $input 变量访问输入数据
4. 表达式区分大小写，确保输入的表达式语法正确
5. 文本框中的更改会在编辑完成后（按Enter键或失去焦点）立即生效
6. 节点配置（表达式）会随流程文件一起保存和加载
7. 当输入数据为空时，节点将返回false
8. 如果JavaScript表达式出现错误，会在控制台输出错误信息并返回false

## 技术细节
- 节点使用QLineEdit实现表达式输入界面
- 使用QJSEngine执行JavaScript表达式
- 通过JSEngineDefines命名空间中的函数在C++和JavaScript之间转换数据
- 使用QJsonObject保存和加载配置数据
- 通过信号槽机制实现表达式变化时的实时更新
- 支持通过dataUpdated信号通知下游节点数据已更新
- 节点继承自NodeDelegateModel，支持嵌入式界面、可调整大小和端口编辑功能
- 使用智能指针管理内存，确保数据安全