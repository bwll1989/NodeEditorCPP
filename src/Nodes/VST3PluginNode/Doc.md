# VST3PluginNode 帮助文档

## 概述
VST3PluginNode 是一个VST3音频插件宿主节点，负责加载和运行VST3格式的音频插件，支持实时音频处理、参数控制和插件界面显示功能。此节点为音频处理节点，用于在音频处理链中插入VST3插件。现处于alpha版本，功能尚不完善。不保证vst3插件的兼容性。



## 功能特性
- **VST3插件支持**：完整支持VST3标准音频插件
- **实时音频处理**：48kHz采样率，4096样本块大小的实时处理
- **插件界面**：支持显示VST3插件的原生控制界面
- **参数控制**：支持VST3插件参数的读取和设置
- **自动扫描**：启动时自动扫描./vst3目录下的插件文件
- **音频缓冲**：使用 AudioTimestampRingQueue 进行高效音频数据传输
- **多总线支持**：支持多输入/输出音频总线配置
- **状态保存**：支持插件选择状态的保存和恢复

## 输入端口
- **端口类型**：AudioData
- **端口数量**：1个
- **数据格式**：AudioTimestampRingQueue 共享缓冲区
- **功能**：接收音频数据进行VST3插件处理

## 输出端口
- **端口类型**：AudioData
- **端口数量**：1个
- **数据格式**：AudioTimestampRingQueue 共享缓冲区
- **功能**：输出经过VST3插件处理后的音频数据

## 界面组件
- **插件选择下拉框**："VST3Selector" - 选择要加载的VST3插件
- **控制界面按钮**："Controller" - 打开/关闭VST3插件的原生控制界面
- **预设选择框**："LoadPreset" - 加载插件预设（功能预留）

## 音频处理参数
- **采样率**：48000 Hz（固定）
- **块大小**：4096 samples（约85.33ms）
- **位深度**：32位浮点
- **处理模式**：实时处理
- **定时器间隔**：约42ms（块大小时间的一半）

## 技术实现
- **VST3 SDK**：基于Steinberg VST3 SDK 3.7.14
- **插件加载**：VST3::Hosting::Module 模块加载
- **音频处理**：IAudioProcessor 接口实现
- **参数管理**：IParameterChanges 接口支持
- **界面集成**：IPlugView 原生界面显示
- **内存管理**：智能指针和RAII模式

## 使用说明
1. 将VST3插件文件（.vst3）放置在项目根目录的 `./vst3/` 文件夹中
2. 启动节点编辑器，VST3PluginNode会自动扫描可用插件
3. 从下拉菜单中选择要使用的VST3插件
4. 插件加载成功后，"Controller"按钮会变为可用状态
5. 点击"Controller"按钮打开插件的原生控制界面
6. 连接音频输入端口到音频源节点
7. 连接音频输出端口到音频输出或其他处理节点
8. 实时音频处理将自动开始

## 支持的VST3插件
- 标准VST3音频效果器插件
- 支持32位浮点音频处理的插件
- 支持48kHz采样率的插件
- 兼容VST3标准的所有插件类型

## 错误处理
- **插件加载失败**：检查插件文件完整性和兼容性
- **音频处理错误**：自动尝试不同音频配置参数
- **接口验证**：确保插件实现了必需的VST3接口
- **资源清理**：插件切换时自动清理旧资源

## 注意事项
- 确保VST3插件文件放置在正确的 `./vst3/` 目录中
- 插件必须支持32位浮点音频处理
- 建议使用支持48kHz采样率的插件以获得最佳性能
- 插件控制界面窗口可以通过再次点击"Controller"按钮关闭
- 节点销毁时会自动停止音频处理并清理所有资源
- 某些插件可能需要特定的初始化顺序，如遇问题请检查插件文档

## 故障排除
- **"未找到VST3插件"**：检查 `./vst3/` 目录是否存在且包含.vst3文件
- **"Failed to start audio processing"**：插件可能不支持当前音频配置
- **插件界面无法显示**：插件可能不支持编辑器界面或存在兼容性问题
- **音频处理中断**：检查音频缓冲区连接和插件状态